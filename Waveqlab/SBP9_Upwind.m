%9th order

m=70; %problemstorlek
%h=1/(m-1);
h=1;
   
x=linspace(0,1,m);x=x';

x0=x.^0/factorial(1); 
x1=x.^1/factorial(1);
x2=x.^2/factorial(2);
x3=x.^3/factorial(3);
x4=x.^4/factorial(4);
x5=x.^5/factorial(5);
x6=x.^6/factorial(6);
x7=x.^7/factorial(7);
x8=x.^8/factorial(8);
x9=x.^9/factorial(9);
x10=x.^10/factorial(10);
x11=x.^11/factorial(11);
x12=x.^12/factorial(12);
x13=x.^13/factorial(13);
x14=x.^14/factorial(14);
x15=x.^15/factorial(15);
c=ones(m,1);

%The coefficients in the norm are given by

H_diag = ones(8,1);

H_diag(1) = 1070017/3628800;
H_diag(2) = 5537111/3628800;
H_diag(3) = 103613/403200;
H_diag(4) = 261115/145152;
H_diag(5) = 298951/725760;
H_diag(6) = 515677/403200;
H_diag(7) = 3349879/3628800;
H_diag(8) = 3662753/3628800;

H_diag1 = diag(H_diag);
H_diag2 = diag(flipud(H_diag));

H 				=	diag(ones(m,1),0);
H(1:8,1:8)		=	H_diag1;
H(m-7:m,m-7:m)	=	H_diag2;
H 				= 	H*h;
HI 				= 	inv(H);


Qp = diag(zeros(m,1));

Qp =+ 1/504  	* diag(ones(m-4,1),-4)...
	- 1/42  	* diag(ones(m-3,1),-3)...
	+ 1/7  		* diag(ones(m-2,1),-2)...
	- 2/3  		* diag(ones(m-1,1),-1)...
	- 1/5  		* diag(ones(m  ,1),0)...
	+ 1			* diag(ones(m-1,1),1)...
	- 1/3  		* diag(ones(m-2,1),2)...
	+ 2/21  	* diag(ones(m-3,1),3)...
	- 1/56  	* diag(ones(m-4,1),4)...
	+ 1/630  	* diag(ones(m-5,1),5);


Qp_c_stencil = [+1/504 -1/42 +1/7 -2/3 -1/5 +1 -1/3 +2/21 -1/56 +1/630];

Qm_c_stencil = -fliplr(Qp_c_stencil);

%rats(Qp_c_stencil)
%rats(Qm_c_stencil)


%The coefficients in Q + are given by

Q_U = diag(zeros(8,1));

Q_U(1,1) = -5561/47263920;
Q_U(1,2) = 4186300102421/6193464076800;
Q_U(1,3) = - 377895002003/5806372572000;
Q_U(1,4) = - 16485548951749/111482353382400;
Q_U(1,5) = - 113245973003/3716078446080;
Q_U(1,6) = 355360297339/4645098057600;
Q_U(1,7) =321012170669/55741176691200;
Q_U(1,8) = - 388397049437/26543417472000;
Q_U(2,1) = - 4178798062421/6193464076800;
Q_U(2,2) = -493793/141791760;
Q_U(2,3) = 725405227507/2413037952000;
Q_U(2,4) = 3904159533697/9290196115200;
Q_U(2,5) = 2483046570341/13935294172800;
Q_U(2,6) = - 4336328670953/18580392230400;
Q_U(2,7) = - 1258688487061/37160784460800;
Q_U(2,8) = 12931584852209/278705883456000;
Q_U(3,1) = 363359390003/5806372572000;
Q_U(3,2) = - 7539548734577/26543417472000;
Q_U(3,3) = - 69332623/2977626960;
Q_U(3,4) = 9994352248429/18580392230400;
Q_U(3,5) = - 8195655811631/18580392230400;
Q_U(3,6) = 7361486640463/61934640768000;
Q_U(3,7) = 5539855071347/92901961152000;
Q_U(3,8) = - 12898722943/422281641600;
Q_U(4,1) = 16773595838149/111482353382400;
Q_U(4,2) = - 372477950627/844563283200;
Q_U(4,3) = - 8659050093229/18580392230400;
Q_U(4,4) = - 207799621/2977626960;
Q_U(4,5) = 1734921317461/2477385630720;
Q_U(4,6) = 2530020015841/18580392230400;
Q_U(4,7) =441856623253/13935294172800;
Q_U(4,8) = - 115132773073/2654341747200;
Q_U(5,1) = 108449122763/3716078446080;
Q_U(5,2) = - 2283566671541/13935294172800;
Q_U(5,3) = 6976424333231/18580392230400;
Q_U(5,4) = - 440819477447/825795210240;
Q_U(5,5) = - 55386253/425375280;
Q_U(5,6) = 2479572560009/3716078446080;
Q_U(5,7) = - 40258468963/120651897600;
Q_U(5,8) = 11808221047099/111482353382400;
Q_U(6,1) = - 32231128289/422281641600;
Q_U(6,2) = 4244793299753/18580392230400;
Q_U(6,3) = - 5173673584463/61934640768000;
Q_U(6,4) = - 4848139955041/18580392230400;
Q_U(6,5) = - 1506045711689/3716078446080;
Q_U(6,6) = - 526653889/2977626960;
Q_U(6,7) = 36411368691307/37160784460800;
Q_U(6,8) = - 825434105779/2903186286000;
Q_U(7,1) = - 316459841069/55741176691200;
Q_U(7,2) = 1277069729941/37160784460800;
Q_U(7,3) = - 6499182375347/92901961152000;
Q_U(7,4) =355606625147/13935294172800;
Q_U(7,5) = 1519272420551/9290196115200;
Q_U(7,6) = - 2240079855137/3378253132800;
Q_U(7,7) = - 584765899/2977626960;
Q_U(7,8) = 2301241355533/2382101568000;
Q_U(8,1) =387779289437/26543417472000;
Q_U(8,2) = - 12908508708209/278705883456000;
Q_U(8,3) = 147710908133/4645098057600;
Q_U(8,4) =534025841911/18580392230400;
Q_U(8,5) = - 4119981443899/111482353382400;
Q_U(8,6) = 279819152779/2903186286000;
Q_U(8,7) = - 1510324515533/2382101568000;
Q_U(8,8) = - 85017967/425375280;


Qp(1:8,1:8) 	=	Q_U;
Qp(m-7:m,m-7:m) =	flipud( fliplr(Q_U ) )';

Qm=-Qp';

e_1=zeros(m,1);e_1(1)=1;
e_m=zeros(m,1);e_m(m)=1;

Dp=HI*(Qp-1/2*e_1*e_1'+1/2*e_m*e_m') ;

Dm=HI*(Qm-1/2*e_1*e_1'+1/2*e_m*e_m') ;

%Dp'*H + H*Dm

% for i = 1:15
%     
%     figure(i);
%     
%     eval('plot(x,Dp*(x'+string(i)+'))')
%     
%     hold on 
%     
%     eval('plot(x,Dm*(x'+string(i)+'))')
%     
%     hold on
%     
%     eval('plot(x,x'+string(i-1)+')')
%     
%     hold on
%    
% end 

diary('9th_order_fortran.txt');
WQLABSTENCILCONVERT_X
WQLABSTENCILCONVERT_Y
WQLABSTENCILCONVERT_Z
diary('off');













